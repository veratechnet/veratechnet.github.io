//    Read embed application token from textbox
var txtAccessToken = "H4sIAAAAAAAEAB2WtQ7sCBJF_-WlHsnUppEmMDOzMzMz92r_fXs2r6TO1YX__LHSd5jT4s_ff_aUSmzPj7_IZ6UW52R5SoqI43Omm3TXo7P3KQKZJI4N4_T6VN1iWmGaOEcKsME3iaOtUCntFIS_0zL2RJ1cUdGH36i4o66Fs51-sMrkhNr72I016Y_aoZH7JWIfSBm2GnkicGBxspUdV5CCVzgcsUR9Y88hEbIYRhuzjIVxCr122-tJjcCMfpEqFQ7RARJF7wgXW7Pb3YCNaTOzFYea4rMQbnSQjnYofzHo5muzsiRGTPTAyXvZWqqPeDvURUn9d3TZAzMWTdyw-nMWFK8Ldc1HLodga7lFQlA-elewqqg6IZTDJsdUJP6Ra8QFRpiF2tPA4ktAeiYF3wOtaj-iIUz7YeHafCbyx1FLoY_q7z0sLsX3brhf5meLx4ipwOGoUbtXohNwvtBa18pIkzqYJ7WIfOum7IPWWRa3nlxjthMWLxNj9R0MbEQHBiOloNOQB1gmyMCblLQxpRFow9OCHH1d4Ot0jwvHdQbKx9eIXc7OhuX70fJSaZeMtREj3jbMXwlAeHMfjyFJMR-spMMbS5eVXUXKd7V1S-bzWyDGTgkajB6p1PpIPTECfTvGSW4akmwSVQpaMMFqfESPiwMnIsRJ8vl4VwAX6XBfw8pxJ2OxOw8NOdVcMPDxzeqWr_GQi1Bf4H0tOg5FucACWWQuNh89swG5naJndWElN_fAdaLHmZxjvlKH8bItTFIjqME76Gwq3BM-4EC2diKq5EvczF_BQZ7YwM56Go8rzVKBWsiUMvUy9nyZHBF2K65jKKsABJCHwCZNb6U3FKK66ZB-q8acYlovXu0mZajbguH0C8uCpl9Zv8pskZ6T7mrfwgscC_PxjK6KR7UShResXijgBl8TzZLqcOVrnYHS2KAhUlliBELIj84ljOgGJ9r351IIKkztWd8i-Ajei2JNjqKBepA6aAqQ41QsdSXyn2j0drXNvnaYhHyVBXs4VdnQDVTuNdxWc3igT6_lIM1M5oYxbI9C23wkwkZmxKW-mRLQ5SCPvy3SBQx7VYtm8W9bQ5sb0adef4rAVWeZOAFert8SU3sWzqbBONqiyfxhhWywXHgGMKph3CePDMziA9jyw3k7NzonwYnVaNFKOo9kWLrofoTBxxnE1M2Ab62gTb5QVM4EBfi0pYtrFvpNnjtfpm5-l4IHo7cVz9T5ArToiESF6wK3Mi_josvwOdcvQxam70o4ZcoSC5uFruVOZqOvmGm3d7XwtN6kcu64elFY-kqAaFlZBz0QArEd-UugEUgyp9YGMFHNkyK10FjBx6hnxoHU3tuY4KNiFtrHOuCPyrRYpapCFrn7kvIV3smxuojJLrQIeyBSMeSrB4IXsU1ouoRMln11AZc_irlJBtAG2Uqox3haqe8Jsi33OY5IgRtooQf2MsH2EANQBbPEnXFK74ePI3uI635T7lroU7y9wL80vnbCsA2fKY2Wg67pg8mSHmJVJutvBKeMH2Fg1TW9C1qe-WqfXTnEpwSis-9ej4F80_F9I720bXhHD7eiJMADx3c39srZQkO1aiTybOXgGEbQomAcV3hnup2AnwqmLNiFmKb6yoZHHzFms5xcLZJNTkSbc_XsB-WLj5_NoE0oKZz7dMkHeR_gBiOxBtcLhHccsTtzsEAk21vdmu2amCmxkfHR50rKgUdo-EnSCMVg0O2Xv6HwEcaF0Ixe_gbUicY4A0rGvR3dHbY7Ao-RdVXFkeNzMzJcC0s-HriX6UQ31P1snduAYEmoRhbFXeANrc_aI2i_SihpxXAz5eM8xht3EGzm-6OBFMNfpO4aZ5owKX9qBr2QHfETQn11nNeLX9dpc9f63UTdjfmL-MY65DwlisH0Tm8GQHRBZZxabc8CdPl8e50mYnZN8Xa8dIeaKvBkIwzyPPcZiQaN5NU9B0QsfLXPwNCZHLz4UoCwDHUkb1UOSXCMAWJnPSgf5dpiVixxF9u3md15pA9Ny-DUGQbWTvn71cBWforOAE7o9wwfzTTkENCrcskzwIy2y-oG-UrE3hIOwN17d859h67jOeMiiOCQ7gtCfI33drjUJ71n38SOHX6Z7ZHSDqsP-TOIa7phcSWqdegtSKGzK7mnVSS1fkpDaxDGHNGtWssBB5H0wzSxbd9kTeN5E5DuEefMCwoTSdlEmnYEXnp21qpFJFjoaZgZ9O6fSsMTsDgJwiAFwvisCNoRtpKYQ_Hnrz_s9i7HrJbvb47YCM2-5OKadUsfR-fyFLdX0Om200hf0PgEYTn7DcWV5TXIsnlaneooigCj6Y-ehU6QB2jxp6DR-BhaE_KkqyhPXc63uflgI4r4QX4d2bRioT-l11KvFvzOYZWCwNFXlLOPEj7yYMnXdfg9qMn0Ljt7gFSYKdvZc4hb9edkaYZUEEMdxJi4Vyt02mFiim_Zcrx2DSHg70WsMoNdHmVwo3myVHM4CrA3LlovuS81JHpb3QMLVKNAdKA53Cg70bWwVyy-dN84WeQZKvnbXe2g8k95jg25rEMsxiEY7oBjnn-ZYHCYhggHV49ZZbSnyprUPUSAochuxFCV6oUkUQF0qpm_uv_nn38xv0tTbnLwowyhirp_zHeI2Mmo5VluyQm7_3_ltvWUHudW_s6UqstKTFcy5xt1xaLTCmojvKt8gE5G3yVUKzpZqMV6NVJn4XQm6l2fgJOssUn2bP38udNkACDgsNaYWh76OuLMT_LHz8_7aXx4xLpBH40hw4cwDCPpBeNzdFRJLm5gfmAkO1hd5DxJc3YCQNFc-fW_rruCbGIWEQ2aFGxAVgOcmqu4EWbMhS5KsOQKVG6i-uAZdqz8q-3oBaQLmJzoRmCxCvtg2zkA8r2PVBA5DAv3N8h_C8BL3faWQfgrpvAI62I3GiHn2JHHhEVE07eWrGGbpQG3dpozxrg3w8AAVZ_fbrtTFZnqFbNINb9iq3lUanPK6nos8nJWeiSgSz3tOGMtR_oX83__B0eLhUCCCwAA";

// Read embed URL from textbox
var txtEmbedUrl ="https://app.powerbi.com/reportEmbed?reportId=f6bfd646-b718-44dc-a378-b73e6b528204&groupId=be8908da-da25-452e-b220-163f52476cdd&config=eyJjbHVzdGVyVXJsIjoiaHR0cHM6Ly9XQUJJLVVTLU5PUlRILUNFTlRSQUwtcmVkaXJlY3QuYW5hbHlzaXMud2luZG93cy5uZXQifQ%3d%3d";

// Read report Id from textbox
var txtEmbedReportId = "f6bfd646-b718-44dc-a378-b73e6b528204";

// Read embed type from radio
var tokenType = "1";

// Get models. models contains enums that can be used.
var models = window['powerbi-client'].models;

// We give All permissions to demonstrate switching between View and Edit mode and saving report.
var permissions = models.Permissions.All;

// Embed configuration used to describe the what and how to embed.
// This object is used when calling powerbi.embed.
// This also includes settings and options such as filters.
// You can find more information at https://github.com/Microsoft/PowerBI-JavaScript/wiki/Embed-Configuration-Details.
var config = {
    type: 'report',
    tokenType: tokenType == '0' ? models.TokenType.Aad : models.TokenType.Embed,
    accessToken: txtAccessToken,
    embedUrl: txtEmbedUrl,
    id: txtEmbedReportId,
    permissions: permissions,
    settings: {
        filterPaneEnabled: true,
        navContentPaneEnabled: true
    }
};

// Get a reference to the embedded report HTML element
var embedContainer = $('#embedContainer')[0];

// Embed the report and display it within the div container.
var report = powerbi.embed(embedContainer, config);

// Report.off removes a given event handler if it exists.
report.off("loaded");

// Report.on will add an event handler which prints to Log window.
report.on("loaded", function () {
    Log.logText("Loaded");
});

// Report.off removes a given event handler if it exists.
report.off("rendered");

// Report.on will add an event handler which prints to Log window.
report.on("rendered", function () {
    Log.logText("Rendered");
});

report.on("error", function (event) {
    Log.log(event.detail);

    report.off("error");
});

report.off("saved");
report.on("saved", function (event) {
    Log.log(event.detail);
    if (event.detail.saveAs) {
        Log.logText('In order to interact with the new report, create a new token and load the new report');
    }
});